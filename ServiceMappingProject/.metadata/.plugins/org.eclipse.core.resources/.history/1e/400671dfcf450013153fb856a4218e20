package DataBase;

import java.sql.PreparedStatement;
import java.sql.SQLException;

import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.MessageBox;

import Main.MainFrame;

public class DBWork_Update {

	//서비스 속성값 수정
	public void updateService(String companyName, String parentServiceName, String childServiceName,	//등록할 서비스 위치 속성
			String name, String definition, String domainTask, String sType, String synonymousNames,	//Identifying 속성
			double priority, String condition, String interfaceName, String businessProcess, 
			String component,   
			String mandatoryFunction, String secondaryFunction, 									  	//Functional 속성
			String servicePropertyString,														  		//Selective 속성
			String andProperty, String orProperty){												  		//Relational 속성

		String updateQuery = "update " + companyName + " set Name = ?, Definition = ?, DomainTask = ?, SType = ?, SynonymousNames = ?," +
				" Priority = ?, ConditionProperty = ?, Interface = ?, businessProcess = ?, Component = ?," +
				" MandatoryFunction = ?, SecondaryFunction = ?, " +
				" Property = ?, andProperty = ?, orProperty = ?," +	
				" ParentService = ?, ChildService = ?" +
				" where Name = ?";
		try{
			PreparedStatement updateServiceStatement = DBConnection.connection.prepareStatement(updateQuery);
			//Identifying Attributes
			updateServiceStatement.setString(1, name);		
			updateServiceStatement.setString(2, definition);
			updateServiceStatement.setString(3, domainTask);
			updateServiceStatement.setString(4, sType);
			updateServiceStatement.setString(5, synonymousNames);
			updateServiceStatement.setDouble(6, priority);
			updateServiceStatement.setString(7, condition);
			updateServiceStatement.setString(8, interfaceName);
			updateServiceStatement.setString(9, businessProcess);
			updateServiceStatement.setString(10, component);

			//Functional Attributes
			updateServiceStatement.setString(11, mandatoryFunction);
			updateServiceStatement.setString(12, secondaryFunction);

			//Selective Attributes
			updateServiceStatement.setString(13, servicePropertyString);

			//Relational Attributes
			updateServiceStatement.setString(14, andProperty);
			updateServiceStatement.setString(15, orProperty);

			//등록할 서비스 위치 속성
			updateServiceStatement.setString(16, parentServiceName);
			updateServiceStatement.setString(17, childServiceName);

			//Where절
			updateServiceStatement.setString(18, name);
			updateServiceStatement.executeUpdate(); 

			MessageBox updateMessageBox = new MessageBox(MainFrame.shell, SWT.ICON_INFORMATION);
			updateMessageBox.setText("Update");
			updateMessageBox.setMessage("Update Success");
			updateMessageBox.open();	
		}
		catch(SQLException sqlException){
			sqlException.printStackTrace();
			MessageBox errorMessageBox = new MessageBox(MainFrame.shell, SWT.ICON_ERROR);
			errorMessageBox.setText("Failed");
			errorMessageBox.setMessage("Update Failed");
			errorMessageBox.open();	
		}
	}
}
